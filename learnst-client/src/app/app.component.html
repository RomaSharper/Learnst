<div class="loading-screen" [class.visible]="loading()">
  <img class="loading-background" noDownloading alt="Welcome to Learnst" [src]="isMediumScreen
    ? '/assets/gifs/niko-loading-small.gif'
    : '/assets/gifs/niko-loading-large.gif'">
</div>

<div class="content" [class.visible]="!loading()">
  <nav class="main-navigation">
    <div class="background-overlay" [class.active]="isMenuOpen()"
      (click)="closeMenu($event)"></div>

    <button type="button" class="hamburger" mat-icon-button
      (click)="toggleMenu($event)">
      <mat-icon>menu</mat-icon>
    </button>

    @if (isMediumScreen) {
      <ul class="mobile-menu" [class.active]="isMenuOpen()">
        @if (user()) {
          <li>
            <a
              routerLink="/"
              class="logo-link"
              routerLinkActive="active"
              [routerLinkActiveOptions]="{ exact: true }"
            >
              <img src="assets/icons/favicon.png" alt="Learnst">
              <span>Learnst</span>
            </a>
          </li>
          <li><a routerLink="/activities" routerLinkActive="active">Обучение</a></li>
          <li><a routerLink="/community" routerLinkActive="active">Сообщество</a></li>
          <li><a routerLink="/support" routerLinkActive="active">Поддержка</a></li>
          <li><a routerLink="/manuals" routerLinkActive="active">Информация</a></li>
          <li class="user-area">
            <button type="button" mat-stroked-button class="user-btn" routerLinkActive="active"
              [matTooltip]="user()?.username" [matMenuTriggerFor]="userMenu">
              <img [alt]="user()?.username" [src]="user()?.avatarUrl" noDownloading
                placeholder="/assets/icons/user-192x192.png">
              <span class="user-name">{{ user()!.username | ellipsis: 10 }}</span>
            </button>

            <mat-menu #userMenu="matMenu">
              <app-user-menu [user]="user()" />
            </mat-menu>
          </li>
        } @else {
          <li><a routerLink="/" routerLinkActive="active" [routerLinkActiveOptions]="{ exact: true }">Главная</a></li>
          <li><a routerLink="/manuals" routerLinkActive="active">Информация</a></li>
          <li class="user-area">
            <a mat-stroked-button routerLink="/login">
              <mat-icon class="scale-1-5">login</mat-icon>
              Войти
            </a>
          </li>
        }
      </ul>
    } @else {
      <div class="desktop-panel">
        <ul class="desktop-menu">
          <li>
            <a class="logo-link" routerLink="/">
              <img src="assets/icons/favicon.png" alt="Learnst">
              <span class="link-label">Learnst</span>
            </a>
          </li>
          <li><a routerLink="/activities" routerLinkActive="active">Активности</a></li>
          <li><a routerLink="/support" routerLinkActive="active">Поддержка</a></li>
          <li><a routerLink="/community" routerLinkActive="active">Сообщество</a></li>
          <li><a routerLink="/manuals" routerLinkActive="active">Информация</a></li>
        </ul>

        @if (user()) {
          <div class="user-area">
            <button type="button" [matTooltip]="user()?.username" mat-icon-button [matMenuTriggerFor]="userMenu">
              <img [src]="user()?.avatarUrl" [alt]="user()?.username" class="user-avatar"
                placeholder="/assets/icons/user-192x192.png">
            </button>

            <mat-menu #userMenu="matMenu" class="user-menu-container">
              <app-user-menu [user]="user()" [redirectOnly]="false" />
            </mat-menu>
          </div>
        } @else {
          <a mat-stroked-button class="login-btn" routerLink="/login">Войти</a>
        }
      </div>
    }
  </nav>

  <router-outlet></router-outlet>
</div>
