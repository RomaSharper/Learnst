<div class="loading-screen" [class.visible]="loading()">
  <div class="loading-content">
    <img class="loading-logo" alt="Learnst" src="/assets/icons/favicon.png" noDownloading>
    <h1 class="loading-title">Learnst</h1>
    @if (welcomeMessage()) {
      <p class="welcome-message">{{ welcomeMessage() }}</p>
    } @else {
      <mat-spinner class="loading-spinner" diameter="50"></mat-spinner>
    }
  </div>
</div>

<div class="content" [class.visible]="!loading()">
  <nav class="main-navigation">
    <div class="background-overlay" [class.active]="isMenuOpen()"
      (click)="closeMenu($event)"></div>

    <button type="button" class="hamburger" mat-icon-button
      (click)="toggleMenu($event)">
      <mat-icon>menu</mat-icon>
    </button>

    @if (isMediumScreen) {
      <ul class="mobile-menu" [class.active]="isMenuOpen()">
        @if (user()) {
          <li><a routerLink="/" routerLinkActive="active" [routerLinkActiveOptions]="{ exact: true }">Главная</a></li>
          <li><a routerLink="/activities" routerLinkActive="active">Обучение</a></li>
          <li><a routerLink="/users" routerLinkActive="active">Пользователи</a></li>
          <li><a routerLink="/tickets" routerLinkActive="active">Поддержка</a></li>
          <li class="user-area">
            <button type="button" mat-stroked-button class="user-btn" routerLinkActive="active"
              [title]="user()?.username" [matMenuTriggerFor]="userMenu">
              <img [alt]="user()?.username" [src]="user()!.avatarUrl" noDownloading
                [title]="user()!.username" placeholder="/assets/icons/user-192x192.png">
              <a class="user-name" routerLinkActive="active">{{ user()!.username }}</a>
            </button>
            <mat-menu #userMenu="matMenu" class="user-menu-container">
              <app-user-menu [user]="user()!" />
            </mat-menu>
          </li>
        } @else {
          <li><a routerLink="/" routerLinkActive="active" [routerLinkActiveOptions]="{ exact: true }">Главная</a></li>
          <li><a routerLink="/manuals/privacypolicy" routerLinkActive="active">Конфиденциальность</a></li>
          <li><a routerLink="/manuals/termsofuse" routerLinkActive="active">Условия пользования</a></li>
          <li class="user-area">
            <a mat-stroked-button routerLink="/login">
              <mat-icon class="scale-1-5">login</mat-icon>
              Войти
            </a>
          </li>
        }
      </ul>
    } @else {
      <div class="desktop-panel">
        <ul class="desktop-menu">
          <li>
            <a class="logo-link" routerLink="/">
              <img src="assets/icons/favicon.png" alt="Learnst">
              <span>Learnst</span>
            </a>
          </li>
          <li>
            <a>Основы</a>
            <div class="submenu">
              <div class="columns">
                <div>
                  <h3>О сайте</h3>
                  <ul>
                    <li><a routerLink="/manuals/intro">Введение</a></li>
                    <li><a routerLink="/manuals/basics">Концепции и правила</a></li>
                  </ul>
                </div>
                <div>
                  <h3>Обучение</h3>
                  <ul>
                    <li><a routerLink="/activities">Активности</a></li>
                    <li><a [routerLink]="['/activities']" [queryParams]="{ tags: 'java' }">Java</a></li>
                    <li><a [routerLink]="['/activities']" [queryParams]="{ tags: 'c#' }">C#</a></li>
                    <li><a [routerLink]="['/activities']" [queryParams]="{ tags: 'lua' }">Lua</a></li>
                  </ul>
                </div>
                <div>
                  <h3>Информация</h3>
                  <ul>
                    <li><a routerLink="/manuals/user">Для пользователя</a></li>
                    <li><a routerLink="/manuals/specialist">Для специалиста</a></li>
                    <li><a routerLink="/manuals/privacypolicy">Конфиденциальность</a></li>
                    <li><a routerLink="/manuals/termsofuse">Условия использования</a></li>
                  </ul>
                </div>
              </div>
            </div>
          </li>
          <li>
            <a>Разработка</a>
            <div class="submenu">
              <div class="columns">
                <div>
                  <h3>Инструменты разработчика</h3>
                  <ul>
                    <li><a routerLink="/code/js">Песочница JavaScript</a></li>
                    <li><a routerLink="/code/java">Песочница Java</a></li>
                    <li><a routerLink="/code/csharp">Песочница C#</a></li>
                  </ul>
                </div>
                <div>
                  <h3>Полезные библиотеки</h3>
                  <ul>
                    <li><a routerLink="/manuals/libs/maven">Maven (Gradle)</a></li>
                    <li><a routerLink="/manuals/libs/nuget">NuGet</a></li>
                    <li><a routerLink="/manuals/libs/npm">NPM</a></li>
                  </ul>
                </div>
              </div>
            </div>
          </li>
          <li>
            <a routerLink="/community">Сообщество</a>
          </li>
        </ul>
        @if (user()) {
          <div class="user-area">
            <button type="button" [title]="user()?.username" mat-icon-button [matMenuTriggerFor]="userMenu">
              <img [src]="user()?.avatarUrl" [alt]="user()?.username" class="user-avatar"
                placeholder="/assets/icons/user-192x192.png">
            </button>

            <mat-menu #userMenu="matMenu" class="user-menu-container">
              <app-user-menu [user]="user()!" />
            </mat-menu>
          </div>
        } @else {
          <a mat-stroked-button class="m-step" routerLink="/login">Войти</a>
        }
      </div>
    }
  </nav>

  <router-outlet></router-outlet>
</div>